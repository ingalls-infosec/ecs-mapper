[
  {
    "date": {
      "field": "@timestamp",
      "target_field": "@timestamp",
      "formats": [
        "UNIX_MS"
      ],
      "timezone": "UTC",
      "ignore_failure": true
    }
  },
  {
    "set": {
      "field": "agent.version",
      "value": "{{agentversion}}",
      "if": "ctx.agentversion != null"
    }
  },
  {
    "set": {
      "field": "event.risk_score",
      "value": "{{cylancescore}}",
      "if": "ctx.cylancescore != null"
    }
  },
  {
    "set": {
      "field": "vulnerability.description",
      "value": "{{description}}",
      "if": "ctx.description != null"
    }
  },
  {
    "set": {
      "field": "destination.ip",
      "value": "{{dest_ip}}",
      "if": "ctx.dest_ip != null"
    }
  },
  {
    "set": {
      "field": "destination.ip",
      "value": "{{destinationip}}",
      "if": "ctx.destinationip != null"
    }
  },
  {
    "set": {
      "field": "destination.port",
      "value": "{{destinationport}}",
      "if": "ctx.destinationport != null"
    }
  },
  {
    "set": {
      "field": "agent.id",
      "value": "{{deviceid}}",
      "if": "ctx.deviceid != null"
    }
  },
  {
    "set": {
      "field": "agent.id",
      "value": "{{deviceids}}",
      "if": "ctx.deviceids != null"
    }
  },
  {
    "set": {
      "field": "host.hostname",
      "value": "{{devicename}}",
      "if": "ctx.devicename != null"
    }
  },
  {
    "set": {
      "field": "host.hostname",
      "value": "{{devicenames}}",
      "if": "ctx.devicenames != null"
    }
  },
  {
    "set": {
      "field": "destination.ip",
      "value": "{{dst_ip}}",
      "if": "ctx.dst_ip != null"
    }
  },
  {
    "set": {
      "field": "event.id",
      "value": "{{event_id}}",
      "if": "ctx.event_id != null"
    }
  },
  {
    "set": {
      "field": "event.type",
      "value": "{{event_type}}",
      "if": "ctx.event_type != null"
    }
  },
  {
    "set": {
      "field": "event.id",
      "value": "{{eventid}}",
      "if": "ctx.eventid != null"
    }
  },
  {
    "set": {
      "field": "file.name",
      "value": "{{filename}}",
      "if": "ctx.filename != null"
    }
  },
  {
    "set": {
      "field": "file.owner",
      "value": "{{fileowner}}",
      "if": "ctx.fileowner != null"
    }
  },
  {
    "set": {
      "field": "file.path",
      "value": "{{filepath}}",
      "if": "ctx.filepath != null"
    }
  },
  {
    "set": {
      "field": "file.type",
      "value": "{{filetype}}",
      "if": "ctx.filetype != null"
    }
  },
  {
    "set": {
      "field": "process.hash.sha256",
      "value": "{{instigatingprocessimagefilesha256}}",
      "if": "ctx.instigatingprocessimagefilesha256 != null"
    }
  },
  {
    "set": {
      "field": "process.name",
      "value": "{{instigatingprocessname}}",
      "if": "ctx.instigatingprocessname != null"
    }
  },
  {
    "set": {
      "field": "user.name",
      "value": "{{instigatingprocessowner}}",
      "if": "ctx.instigatingprocessowner != null"
    }
  },
  {
    "set": {
      "field": "host.ip",
      "value": "{{ipaddress}}",
      "if": "ctx.ipaddress != null"
    }
  },
  {
    "set": {
      "field": "host.ip",
      "value": "{{local_ip}}",
      "if": "ctx.local_ip != null"
    }
  },
  {
    "set": {
      "field": "user.name",
      "value": "{{loggedonusers}}",
      "if": "ctx.loggedonusers != null"
    }
  },
  {
    "set": {
      "field": "user.domain",
      "value": "{{loginsp}}",
      "if": "ctx.loginsp != null"
    }
  },
  {
    "set": {
      "field": "host.mac",
      "value": "{{macaddress}}",
      "if": "ctx.macaddress != null"
    }
  },
  {
    "set": {
      "field": "hash.md5",
      "value": "{{md5}}",
      "if": "ctx.md5 != null"
    }
  },
  {
    "set": {
      "field": "agent.version",
      "value": "{{opticsversion}}",
      "if": "ctx.opticsversion != null"
    }
  },
  {
    "set": {
      "field": "os.full",
      "value": "{{os}}",
      "if": "ctx.os != null"
    }
  },
  {
    "set": {
      "field": "file.path",
      "value": "{{path}}",
      "if": "ctx.path != null"
    }
  },
  {
    "set": {
      "field": "rule.name",
      "value": "{{policyname}}",
      "if": "ctx.policyname != null"
    }
  },
  {
    "set": {
      "field": "source.port",
      "value": "{{port}}",
      "if": "ctx.port != null"
    }
  },
  {
    "set": {
      "field": "process.pid",
      "value": "{{processid}}",
      "if": "ctx.processid != null"
    }
  },
  {
    "set": {
      "field": "process.name",
      "value": "{{processname}}",
      "if": "ctx.processname != null"
    }
  },
  {
    "set": {
      "field": "event.category",
      "value": "{{product}}",
      "if": "ctx.product != null"
    }
  },
  {
    "set": {
      "field": "source.port",
      "value": "{{service_port}}",
      "if": "ctx.service_port != null"
    }
  },
  {
    "set": {
      "field": "event.severity",
      "value": "{{severity}}",
      "if": "ctx.severity != null"
    }
  },
  {
    "set": {
      "field": "hash.sha256",
      "value": "{{sha256}}",
      "if": "ctx.sha256 != null"
    }
  },
  {
    "set": {
      "field": "source.ip",
      "value": "{{sourceip}}",
      "if": "ctx.sourceip != null"
    }
  },
  {
    "set": {
      "field": "source.ip",
      "value": "{{src_ip}}",
      "if": "ctx.src_ip != null"
    }
  },
  {
    "set": {
      "field": "file.owner",
      "value": "{{targetfileowner}}",
      "if": "ctx.targetfileowner != null"
    }
  },
  {
    "set": {
      "field": "file.path",
      "value": "{{targetfilepath}}",
      "if": "ctx.targetfilepath != null"
    }
  },
  {
    "set": {
      "field": "file.hash.sha256",
      "value": "{{targetfilesha256}}",
      "if": "ctx.targetfilesha256 != null"
    }
  },
  {
    "set": {
      "field": "process.parent.hash.sha256",
      "value": "{{targetprocessimagefilesha256}}",
      "if": "ctx.targetprocessimagefilesha256 != null"
    }
  },
  {
    "set": {
      "field": "process.parent.name",
      "value": "{{targetprocessname}}",
      "if": "ctx.targetprocessname != null"
    }
  },
  {
    "set": {
      "field": "process.parent.owner",
      "value": "{{targetprocessowner}}",
      "if": "ctx.targetprocessowner != null"
    }
  },
  {
    "set": {
      "field": "user.full_name",
      "value": "{{user}}",
      "if": "ctx.user != null"
    }
  },
  {
    "set": {
      "field": "user.name",
      "value": "{{username}}",
      "if": "ctx.username != null"
    }
  }
]